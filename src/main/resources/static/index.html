<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Simple To-Do App</title>
</head>
<body>

<h1>Simple To-Do List</h1>

<form id="task-form">
    <input type="text" id="task-input" placeholder="Enter a new task..." required>
    <button type="submit">Add Task</button>
</form>

<ul id="task-list">
</ul>

<script>
        const taskList = document.getElementById('task-list');
        const taskForm = document.getElementById('task-form');
        const taskInput = document.getElementById('task-input');

        // Function to fetch and display all tasks from the backend
        async function fetchTasks() {
            const response = await fetch('/api/tasks');
            const tasks = await response.json();

            taskList.innerHTML = ''; // Clear the list
            tasks.forEach(task => {
                const li = document.createElement('li');
                li.innerHTML = `
                    ${task.description}
                    <button class="delete-button" data-id="${task.id}">Delete</button>
                `;
                taskList.appendChild(li);
            });
        }

        // Event listener for adding a new task
        taskForm.addEventListener('submit', async (e) => {
            e.preventDefault(); // Prevent page reload
            const description = taskInput.value;

            await fetch('/api/tasks', {
                method: 'POST',
                headers: {
                    'Content-Type': 'application/json'
                },
                body: JSON.stringify({ description: description })
            });

            taskInput.value = ''; // Clear input field
            fetchTasks(); // Refresh the task list
        });

        // Event listener for deleting a task
        taskList.addEventListener('click', async (e) => {
            if (e.target.classList.contains('delete-button')) {
                const taskId = e.target.getAttribute('data-id');

                await fetch(`/api/tasks/${taskId}`, {
                    method: 'DELETE'
                });

                fetchTasks(); // Refresh the task list
            }
        });

        // Fetch tasks on page load
        document.addEventListener('DOMContentLoaded', fetchTasks);
    </script>

</body>
</html>